<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LoreLoom</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/bundle.css" />
  <link id="tokens" rel="stylesheet" href="/css/tokens.css" />
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="left">
      <button id="sidebarToggle" class="btn" title="Alternar menu" aria-label="Alternar menu">☰</button>
      <strong>LoreLoom</strong>
      <span class="status-mini">
        <span class="dot">•</span>
        <span id="status" data-i18n="ready">Pronto</span>
      </span>
    </div>
    <div class="right">
        <div class="dropdown">
            <button class="btn btn-primario" data-i18n="actions">Ações</button>
            <div class="dropdown-content">
                <button class="btn" data-action="saveProject" title="Ctrl/Cmd + S" data-i18n="save_project">Salvar Projeto</button>
                <button class="btn" data-action="exportProject" data-i18n="export">Exportar</button>
                <button class="btn" data-action="triggerImport" data-i18n="import">Importar</button>
            </div>
        </div>
        <input type="file" id="importFile" accept=".json" class="hidden">

        <select id="languageSwitcher" class="ml-8">
            <option value="pt">Português</option>
            <option value="en">English</option>
            <option value="es">Español</option>
        </select>

        <div class="theme-switcher-container" id="themeSwitcher">
            <button id="themeToggle" class="btn-toggle" aria-label="Alternar tema">🌙</button>
            <div class="theme-switcher-options">
                <button data-theme="light">Claro ☀️</button>
                <button data-theme="dark">Escuro 🌙</button>
                <button data-theme="medieval">Medieval 🏰</button>
                <button data-theme="cyberpunk">Cyberpunk 🤖</button>
            </div>
        </div>
    </div>
  </header>

<div class="app">
    <!-- Sidebar única -->
    <aside class="sidebar">
      <div class="sidebar-head">
        <h3 class="m-0" data-i18n="navigation">Navegação</h3>
      </div>

      <div class="content">
        <h3>Estrutura do Livro</h3>
        <p class="text-muted">Arraste para reorganizar os capítulos</p>
        <div class="book-structure">
          <ul class="chapter-list" id="chaptersList">
            <li class="chapter-item active">
              <div>
                <span class="chapter-icon">📄</span>
                <span>Capítulo 1: A Jornada Começa</span>
              </div>
              <div class="chapter-actions">
                <button class="btn btn-sm btn-outline" aria-label="Editar Capítulo 1">✏️</button>
              </div>
            </li>
            <li class="chapter-item">
              <div>
                <span class="chapter-icon">📄</span>
                <span>Capítulo 2: O Encontro</span>
              </div>
              <div class="chapter-actions">
                <button class="btn btn-sm btn-outline" aria-label="Editar Capítulo 2">✏️</button>
              </div>
            </li>
          </ul>
        </div>
        <div class="mt-20">
          <button class="btn btn-outline" id="addPartBtn">+ Adicionar Parte</button>
        </div>
      </div>

      <!-- Navegação -->
      <nav class="tree mt-20">
        <ul class="list-unstyled">
          <li class="nav-item has-submenu active" data-route="editor" data-i18n="editor">📝 Editor
            <ul class="submenu">
              <li class="nav-item" data-route="documents" data-i18n="documents">📄 Textos</li>
            </ul>
          </li>
          <li class="nav-item" data-route="characters" data-i18n="characters">👤 Personagens</li>
          <li class="nav-item" data-route="world" data-i18n="world">🌍 Mundo</li>
          <li class="nav-item" data-route="economy" data-i18n="economy">💱 Economia</li>
          <li class="nav-item" data-route="languages" data-i18n="nav_languages">🔤 Línguas</li>
          <li class="nav-item" data-route="timeline" data-i18n="timeline">⏳ Linha do Tempo</li>
          <li class="nav-item" data-route="notes" data-i18n="notes">🗒️ Notas</li>
        </ul>
      </nav>
    </aside>

    <!-- Main -->
    <main class="main">
      <!-- Breadcrumbs -->
      <div class="crumbs"><span data-i18n="home">Home</span> / <span id="crumb" data-i18n="editor">Editor</span></div>

      <!-- Painel: Editor -->
      <section id="editor" class="content-panel active">
        <div class="card">
          <div class="card-header">
            <h2>Editor de Texto Rico</h2>
          </div>

          <!-- Toolbar agrupada -->
          <div class="editor-toolbar">
            <div role="group">
              <button class="btn" data-action="formatText" data-arg="bold" title="Negrito"><b>B</b></button>
              <button class="btn" data-action="formatText" data-arg="italic" title="Itálico"><i>I</i></button>
              <button class="btn" data-action="formatText" data-arg="underline" title="Sublinhado"><u>U</u></button>
              <button class="btn" data-action="formatText" data-arg="strikethrough" title="Riscado"><s>S</s></button>
            </div>
            <div role="group">
              <button class="btn" data-action="insertRef" data-arg="personagem" title="Inserir referência de personagem" aria-label="Inserir referência de personagem">👤</button>
              <button class="btn" data-action="insertRef" data-arg="local" title="Inserir referência de local" aria-label="Inserir referência de local">🌍</button>
              <button class="btn" data-action="insertItemRef" title="Inserir referência de item" aria-label="Inserir referência de item">📦</button>
            </div>
            <div role="group">
              <button class="btn btn-secundario" data-action="checkConsistency">✔ Consistência</button>
              <button class="btn" id="draftToggleBtn" data-action="toggleDraft" title="Marcar como rascunho/final">🏷️ Rascunho</button>
              <button class="btn" id="grammarBtn" data-action="grammarReview" title="Revisão gramatical">✍️ Revisão</button>
            </div>
            <div role="group">
              <button class="btn" data-action="undo" title="Desfazer (Ctrl/Cmd + Z)">↺</button>
              <button class="btn" data-action="redo" title="Refazer (Ctrl/Cmd + Y)">↻</button>
              <button class="btn" data-action="clearFormatting" title="Limpar formatação">🧹</button>
              <button class="btn" id="saveTextBtn" data-action="saveText" title="Salvar texto (Ctrl/Cmd + S)">💾</button>
            </div>
          </div>

          <!-- Painel revisão -->
          <div id="grammarPanel" class="grammar-panel hidden">
            <div class="grammar-header">
              <strong>Revisão Gramatical</strong>
              <div>
                <button class="btn btn-sm" data-action="applyQuickFixes">Correções rápidas</button>
                <button class="btn btn-sm btn-secundario" data-action="closeGrammarPanel">Fechar</button>
              </div>
            </div>
            <div id="grammarResults" class="grammar-results"></div>
          </div>

          <!-- Documento -->
          <div class="form-group">
            <label for="documentTitle">Título do Documento</label>
            <input type="text" id="documentTitle" class="form-control" placeholder="Digite o título..." value="História sem título">
          </div>

          <div class="form-group">
            <label for="mainText">Conteúdo</label>
            <div id="mainText" class="editor" contenteditable="true" data-placeholder="Comece a escrever sua história..."></div>
          </div>

          <!-- Status -->
          <div class="status-bar">
            <span>Palavras: <strong id="wordCount">0</strong></span>
            <span>Caracteres: <strong id="charCount">0</strong></span>
            <span>Referências: <strong id="refCount">0</strong></span>
            <span id="saveStatus">Rascunho local</span>
            <span class="status-right">Status: <span id="docStatusBadge" class="badge badge-draft">Rascunho</span></span>
          </div>
        </div>
      </section>
      
    <section id="documents" class="content-panel">
      <div class="card">
        <div class="card-header">
          <h2>Textos do Projeto</h2>
          <div>
            <input type="text" id="docSearch" class="form-control search-input" placeholder="Buscar por título..."/>
          </div>
        </div>

        <div id="documentsList" class="document-list"></div>
      </div>
    </section>

      <!-- Painel: Personagens -->
      <section id="characters" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Gerenciador de Personagens</h2>
            <button class="btn btn-primario" data-action="openCharacterModal">Novo Personagem</button>
          </div>
          
          <div class="form-group">
            <input type="text" id="characterSearch" class="form-control" placeholder="Buscar personagens...">
          </div>
          
          <div class="character-list" id="characterList">
            <!-- Exemplo de personagem -->
            <div class="list-item">
              <div>
                <strong>Aragorn</strong>
                <div class="text-sm text-muted">Guardião, Humano</div>
                <div class="tag">Protagonista</div>
                <div class="tag">Rei</div>
              </div>
              <div>
                <button class="btn" data-action="editCharacter" data-arg="aragorn">Editar</button>
                <button class="btn btn-danger" data-action="deleteCharacter" data-arg="aragorn">Excluir</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Painel: Mundo -->
      <section id="world" class="content-panel">
        <div class="tabs">
          <div class="tab active" data-tab="locations">Locais</div>
          <div class="tab" data-tab="factions">Facções</div>
          <div class="tab" data-tab="items">Itens</div>
        </div>
        
        <!-- Sub-painel: Locais -->
        <div id="locations" class="tab-content active">
          <div class="card">
            <div class="card-header">
              <h3>Locais do Mundo</h3>
              <button class="btn btn-primario" data-action="openLocationModal">Novo Local</button>
            </div>
            
            <div class="location-list" id="locationList">
              <div class="list-item">
                <div>
                  <strong>Gondor</strong>
                <div class="text-sm text-muted">Reino • Capital: Minas Tirith</div>
                  <div class="tag">Reino</div>
                  <div class="tag">Importante</div>
                </div>
                <div>
                  <button class="btn" data-action="editLocation" data-arg="gondor">Editar</button>
                  <button class="btn btn-danger">Excluir</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Sub-painel: Facções -->
        <div id="factions" class="tab-content hidden">
          <div class="card">
            <div class="card-header">
              <h3>Facções e Organizações</h3>
              <button class="btn btn-primario" data-action="openFactionModal">Nova Facção</button>
            </div>
            
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Buscar facções...">
            </div>
            
            <div class="list-item">
              <div>
                <strong>Irmandade do Anel</strong>
                <div class="text-sm text-muted">Aliança • 9 membros</div>
                <div class="tag">Protagonistas</div>
              </div>
              <div>
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Sub-painel: Itens -->
        <div id="items" class="tab-content hidden">
          <div class="card">
            <div class="card-header">
              <h3>Itens e Artefatos</h3>
              <button class="btn btn-primario" data-action="openItemModal">Novo Item</button>
            </div>
            
            <div class="grid grid-2">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Buscar itens...">
              </div>
              <div class="form-group">
                <select class="form-control">
                  <option>Todos os tipos</option>
                  <option>Arma</option>
                  <option>Armadura</option>
                  <option>Artefato</option>
                  <option>Consumível</option>
                </select>
              </div>
            </div>
            
            <div class="item-list" id="itemList">
              <div class="list-item">
                <div>
                  <strong>Andúril</strong>
                <div class="text-sm text-muted">Espada • Lendária</div>
                  <div class="tag">Arma</div>
                  <div class="tag">Única</div>
                </div>
                <div>
                  <button class="btn">Editar</button>
                  <button class="btn btn-danger">Excluir</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Painel: Economia -->
      <section id="economy" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Sistema Econômico</h2>
          </div>
          
            <div class="grid grid-2">
              <div>
                <h3>Moedas</h3>
              <div class="form-group">
                <label>Nome da Moeda</label>
                <input type="text" class="form-control" placeholder="ex: Moedas de Ouro">
              </div>
              <div class="form-group">
                <label>Símbolo</label>
                <input type="text" class="form-control" placeholder="ex: 🪙" maxlength="5">
              </div>
              <div class="form-group">
                <label>Taxa de Câmbio (base)</label>
                <input type="number" class="form-control" placeholder="1.0" step="0.1">
              </div>
              <button class="btn btn-primario">Adicionar Moeda</button>
            </div>
            
            <div>
              <h3>Recursos</h3>
              <div class="form-group">
                <label>Nome do Recurso</label>
                <input type="text" class="form-control" placeholder="ex: Minério de Ferro">
              </div>
              <div class="form-group">
                <label>Raridade</label>
                <select class="form-control">
                  <option>Comum</option>
                  <option>Incomum</option>
                  <option>Raro</option>
                  <option>Épico</option>
                  <option>Lendário</option>
                </select>
              </div>
              <div class="form-group">
                <label>Valor Base</label>
                <input type="number" class="form-control" placeholder="100">
              </div>
              <button class="btn btn-primario">Adicionar Recurso</button>
            </div>
          </div>
          
          <div class="card mt-16">
            <h3>Mercados e Preços</h3>
            <table class="table">
              <thead>
                <tr>
                  <th>Item</th>
                  <th>Região</th>
                  <th>Preço</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Pão</td>
                  <td>Gondor</td>
                  <td>2 🪙</td>
                  <td>
                    <button class="btn">Editar</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Painel: Línguas -->
      <section id="languages" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Sistema de Línguas</h2>
            <button class="btn btn-primario" data-action="openLanguageModal">Nova Língua</button>
          </div>
          
          <div class="grid grid-2" id="languageList">
            <div class="card">
              <h3>Élfico (Sindarin)</h3>
              <div class="form-group">
                <label>Família Linguística</label>
                <input type="text" class="form-control" value="Élfica" readonly>
              </div>
              <div class="form-group">
                <label>Falantes</label>
                <input type="text" class="form-control" value="Elfos de Rivendell, Lothlórien" readonly>
              </div>
              <div class="form-group">
                <label>Script</label>
                <input type="text" class="form-control" value="Tengwar" readonly>
              </div>
              <div class="form-group">
                <label>Exemplo</label>
                <textarea class="form-control" rows="2" readonly>Mae govannen - Bem-vindos</textarea>
              </div>
              <button class="btn">Editar</button>
              <button class="btn btn-danger">Excluir</button>
            </div>
            
            <div class="card">
              <h3>Língua Negra</h3>
              <div class="form-group">
                <label>Família Linguística</label>
                <input type="text" class="form-control" value="Línguas Sombrias" readonly>
              </div>
              <div class="form-group">
                <label>Falantes</label>
                <input type="text" class="form-control" value="Orcs, Nazgûl" readonly>
              </div>
              <div class="form-group">
                <label>Script</label>
                <input type="text" class="form-control" value="Runas Sombrias" readonly>
              </div>
              <div class="form-group">
                <label>Exemplo</label>
                <textarea class="form-control" rows="2" readonly>Ash nazg durbatulûk - Um anel para dominá-los</textarea>
              </div>
              <button class="btn">Editar</button>
              <button class="btn btn-danger">Excluir</button>
            </div>
          </div>
          
          <div class="card">
            <h3>Dicionário e Traduções</h3>
            <div class="grid grid-3">
              <div class="form-group">
                <label>Palavra</label>
                <input type="text" class="form-control" placeholder="ex: mellon">
              </div>
              <div class="form-group">
                <label>Língua</label>
                <select class="form-control">
                  <option>Élfico</option>
                  <option>Língua Negra</option>
                </select>
              </div>
              <div class="form-group">
                <label>Tradução</label>
                <input type="text" class="form-control" placeholder="ex: amigo">
              </div>
            </div>
            <button class="btn btn-primario">Adicionar Palavra</button>
          </div>
        </div>
      </section>

      <!-- Painel: Linha do Tempo -->
      <section id="timeline" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Linha do Tempo</h2>
            <button class="btn btn-primario" data-action="openEventModal">Novo Evento</button>
          </div>
          
          <div class="form-group">
            <label>Filtrar por Era/Período</label>
            <select class="form-control">
              <option>Todos os períodos</option>
              <option>Primeira Era</option>
              <option>Segunda Era</option>
              <option>Terceira Era</option>
              <option>Quarta Era</option>
            </select>
          </div>
          
          <div id="eventList" class="timeline">
            <div class="card timeline-entry">
              <div class="timeline-dot bg-primary"></div>
              <strong>T.A. 3018</strong> - Início da Jornada do Anel
              <div class="text-sm text-muted mt-4">
                Frodo deixa o Condado com o Um Anel
              </div>
              <div class="tag">Importante</div>
              <div class="mt-8">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>

            <div class="card timeline-entry">
              <div class="timeline-dot bg-success"></div>
              <strong>T.A. 3019</strong> - Batalha dos Campos de Pelennor
              <div class="text-sm text-muted mt-4">
                Vitória decisiva contra as forças de Mordor
              </div>
              <div class="tag">Batalha</div>
              <div class="mt-8">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>

            <div class="card timeline-entry">
              <div class="timeline-dot bg-warning"></div>
              <strong>T.A. 3019</strong> - Destruição do Anel
              <div class="text-sm text-muted mt-4">
                O Um Anel é destruído na Montanha da Perdição
              </div>
              <div class="tag">Clímax</div>
              <div class="mt-8">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Painel: Notas -->
      <section id="notes" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Notas e Ideias</h2>
            <button class="btn btn-primario" data-action="openNoteModal">Nova Nota</button>
          </div>
          
          <div class="grid grid-2">
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Buscar notas...">
            </div>
            <div class="form-group">
              <select class="form-control">
                <option>Todas as categorias</option>
                <option>Ideias de enredo</option>
                <option>Desenvolvimento de personagens</option>
                <option>Worldbuilding</option>
                <option>Pesquisa</option>
                <option>Referências</option>
              </select>
            </div>
          </div>
          
          <div class="grid grid-2" id="noteList">
            <div class="card">
              <div class="card-header">
                <strong>Sistema de Magia</strong>
                <span class="text-xs text-muted">há 2 dias</span>
              </div>
              <p class="text-sm my-8">
                Desenvolver sistema baseado em palavras de poder. Cada palavra tem custo energético...
              </p>
              <div class="tag">Worldbuilding</div>
              <div class="tag">Magia</div>
              <div class="mt-12">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <strong>Arco do Gandalf</strong>
                <span class="text-xs text-muted">há 1 semana</span>
              </div>
              <p class="text-sm my-8">
                Transformação de Gandalf Cinzento para Branco representa crescimento espiritual...
              </p>
              <div class="tag">Personagem</div>
              <div class="tag">Desenvolvimento</div>
              <div class="mt-12">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
  <script type="module" src="/js/main.js"></script>
  <script src="/js/scripts.js"></script>
  <script src="/js/utils.js"></script>

</body>
</html>
