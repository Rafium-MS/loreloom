<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LoreLoom</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/bundle.css" />
  <link id="tokens" rel="stylesheet" href="/css/tokens.css" />
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="left">
      <button id="sidebarToggle" class="btn" title="Alternar menu" aria-label="Alternar menu">‚ò∞</button>
      <strong>LoreLoom</strong>
      <span class="status-mini">
        <span class="dot">‚Ä¢</span>
        <span id="status" data-i18n="ready">Pronto</span>
      </span>
    </div>
    <div class="right">
        <div class="dropdown">
            <button class="btn btn-primario" data-i18n="actions">A√ß√µes</button>
            <div class="dropdown-content">
                <button class="btn" data-action="saveProject" title="Ctrl/Cmd + S" data-i18n="save_project">Salvar Projeto</button>
                <button class="btn" data-action="exportProject" data-i18n="export">Exportar</button>
                <button class="btn" data-action="triggerImport" data-i18n="import">Importar</button>
            </div>
        </div>
        <input type="file" id="importFile" accept=".json" class="hidden">

        <select id="languageSwitcher" class="ml-8">
            <option value="pt">Portugu√™s</option>
            <option value="en">English</option>
            <option value="es">Espa√±ol</option>
        </select>

        <div class="theme-switcher-container" id="themeSwitcher">
            <button id="themeToggle" class="btn-toggle" aria-label="Alternar tema">üåô</button>
            <div class="theme-switcher-options">
                <button data-theme="light">Claro ‚òÄÔ∏è</button>
                <button data-theme="dark">Escuro üåô</button>
                <button data-theme="medieval">Medieval üè∞</button>
                <button data-theme="cyberpunk">Cyberpunk ü§ñ</button>
            </div>
        </div>
    </div>
  </header>

<div class="app">
    <!-- Sidebar √∫nica -->
    <aside class="sidebar">
      <div class="sidebar-head">
        <h3 class="m-0" data-i18n="navigation">Navega√ß√£o</h3>
      </div>

      <div class="content">
        <h3>Estrutura do Livro</h3>
        <p class="text-muted">Arraste para reorganizar os cap√≠tulos</p>
        <div class="book-structure">
          <ul class="chapter-list" id="chaptersList">
            <li class="chapter-item active">
              <div>
                <span class="chapter-icon">üìÑ</span>
                <span>Cap√≠tulo 1: A Jornada Come√ßa</span>
              </div>
              <div class="chapter-actions">
                <button class="btn btn-sm btn-outline" aria-label="Editar Cap√≠tulo 1">‚úèÔ∏è</button>
              </div>
            </li>
            <li class="chapter-item">
              <div>
                <span class="chapter-icon">üìÑ</span>
                <span>Cap√≠tulo 2: O Encontro</span>
              </div>
              <div class="chapter-actions">
                <button class="btn btn-sm btn-outline" aria-label="Editar Cap√≠tulo 2">‚úèÔ∏è</button>
              </div>
            </li>
          </ul>
        </div>
        <div class="mt-20">
          <button class="btn btn-outline" id="addPartBtn">+ Adicionar Parte</button>
        </div>
      </div>

      <!-- Navega√ß√£o -->
      <nav class="tree mt-20">
        <ul class="list-unstyled">
          <li class="nav-item has-submenu active" data-route="editor" data-i18n="editor">üìù Editor
            <ul class="submenu">
              <li class="nav-item" data-route="documents" data-i18n="documents">üìÑ Textos</li>
            </ul>
          </li>
          <li class="nav-item" data-route="characters" data-i18n="characters">üë§ Personagens</li>
          <li class="nav-item" data-route="world" data-i18n="world">üåç Mundo</li>
          <li class="nav-item" data-route="economy" data-i18n="economy">üí± Economia</li>
          <li class="nav-item" data-route="languages" data-i18n="nav_languages">üî§ L√≠nguas</li>
          <li class="nav-item" data-route="timeline" data-i18n="timeline">‚è≥ Linha do Tempo</li>
          <li class="nav-item" data-route="notes" data-i18n="notes">üóíÔ∏è Notas</li>
        </ul>
      </nav>
    </aside>

    <!-- Main -->
    <main class="main">
      <!-- Breadcrumbs -->
      <div class="crumbs"><span data-i18n="home">Home</span> / <span id="crumb" data-i18n="editor">Editor</span></div>

      <!-- Painel: Editor -->
      <section id="editor" class="content-panel active">
        <div class="card">
          <div class="card-header">
            <h2>Editor de Texto Rico</h2>
          </div>

          <!-- Toolbar agrupada -->
          <div class="editor-toolbar">
            <div role="group">
              <button class="btn" data-action="formatText" data-arg="bold" title="Negrito"><b>B</b></button>
              <button class="btn" data-action="formatText" data-arg="italic" title="It√°lico"><i>I</i></button>
              <button class="btn" data-action="formatText" data-arg="underline" title="Sublinhado"><u>U</u></button>
              <button class="btn" data-action="formatText" data-arg="strikethrough" title="Riscado"><s>S</s></button>
            </div>
            <div role="group">
              <button class="btn" data-action="insertRef" data-arg="personagem" title="Inserir refer√™ncia de personagem" aria-label="Inserir refer√™ncia de personagem">üë§</button>
              <button class="btn" data-action="insertRef" data-arg="local" title="Inserir refer√™ncia de local" aria-label="Inserir refer√™ncia de local">üåç</button>
              <button class="btn" data-action="insertItemRef" title="Inserir refer√™ncia de item" aria-label="Inserir refer√™ncia de item">üì¶</button>
            </div>
            <div role="group">
              <button class="btn btn-secundario" data-action="checkConsistency">‚úî Consist√™ncia</button>
              <button class="btn" id="draftToggleBtn" data-action="toggleDraft" title="Marcar como rascunho/final">üè∑Ô∏è Rascunho</button>
              <button class="btn" id="grammarBtn" data-action="grammarReview" title="Revis√£o gramatical">‚úçÔ∏è Revis√£o</button>
            </div>
            <div role="group">
              <button class="btn" data-action="undo" title="Desfazer (Ctrl/Cmd + Z)">‚Ü∫</button>
              <button class="btn" data-action="redo" title="Refazer (Ctrl/Cmd + Y)">‚Üª</button>
              <button class="btn" data-action="clearFormatting" title="Limpar formata√ß√£o">üßπ</button>
              <button class="btn" id="saveTextBtn" data-action="saveText" title="Salvar texto (Ctrl/Cmd + S)">üíæ</button>
            </div>
          </div>

          <!-- Painel revis√£o -->
          <div id="grammarPanel" class="grammar-panel hidden">
            <div class="grammar-header">
              <strong>Revis√£o Gramatical</strong>
              <div>
                <button class="btn btn-sm" data-action="applyQuickFixes">Corre√ß√µes r√°pidas</button>
                <button class="btn btn-sm btn-secundario" data-action="closeGrammarPanel">Fechar</button>
              </div>
            </div>
            <div id="grammarResults" class="grammar-results"></div>
          </div>

          <!-- Documento -->
          <div class="form-group">
            <label for="documentTitle">T√≠tulo do Documento</label>
            <input type="text" id="documentTitle" class="form-control" placeholder="Digite o t√≠tulo..." value="Hist√≥ria sem t√≠tulo">
          </div>

          <div class="form-group">
            <label for="mainText">Conte√∫do</label>
            <div id="mainText" class="editor" contenteditable="true" data-placeholder="Comece a escrever sua hist√≥ria..."></div>
          </div>

          <!-- Status -->
          <div class="status-bar">
            <span>Palavras: <strong id="wordCount">0</strong></span>
            <span>Caracteres: <strong id="charCount">0</strong></span>
            <span>Refer√™ncias: <strong id="refCount">0</strong></span>
            <span id="saveStatus">Rascunho local</span>
            <span class="status-right">Status: <span id="docStatusBadge" class="badge badge-draft">Rascunho</span></span>
          </div>
        </div>
      </section>
      
    <section id="documents" class="content-panel">
      <div class="card">
        <div class="card-header">
          <h2>Textos do Projeto</h2>
          <div>
            <input type="text" id="docSearch" class="form-control search-input" placeholder="Buscar por t√≠tulo..."/>
          </div>
        </div>

        <div id="documentsList" class="document-list"></div>
      </div>
    </section>

      <!-- Painel: Personagens -->
      <section id="characters" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Gerenciador de Personagens</h2>
            <button class="btn btn-primario" data-action="openCharacterModal">Novo Personagem</button>
          </div>
          
          <div class="form-group">
            <input type="text" id="characterSearch" class="form-control" placeholder="Buscar personagens...">
          </div>
          
          <div class="character-list" id="characterList">
            <!-- Exemplo de personagem -->
            <div class="list-item">
              <div>
                <strong>Aragorn</strong>
                <div class="text-sm text-muted">Guardi√£o, Humano</div>
                <div class="tag">Protagonista</div>
                <div class="tag">Rei</div>
              </div>
              <div>
                <button class="btn" data-action="editCharacter" data-arg="aragorn">Editar</button>
                <button class="btn btn-danger" data-action="deleteCharacter" data-arg="aragorn">Excluir</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Painel: Mundo -->
      <section id="world" class="content-panel">
        <div class="tabs">
          <div class="tab active" data-tab="locations">Locais</div>
          <div class="tab" data-tab="factions">Fac√ß√µes</div>
          <div class="tab" data-tab="items">Itens</div>
        </div>
        
        <!-- Sub-painel: Locais -->
        <div id="locations" class="tab-content active">
          <div class="card">
            <div class="card-header">
              <h3>Locais do Mundo</h3>
              <button class="btn btn-primario" data-action="openLocationModal">Novo Local</button>
            </div>
            
            <div class="location-list" id="locationList">
              <div class="list-item">
                <div>
                  <strong>Gondor</strong>
                <div class="text-sm text-muted">Reino ‚Ä¢ Capital: Minas Tirith</div>
                  <div class="tag">Reino</div>
                  <div class="tag">Importante</div>
                </div>
                <div>
                  <button class="btn" data-action="editLocation" data-arg="gondor">Editar</button>
                  <button class="btn btn-danger">Excluir</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Sub-painel: Fac√ß√µes -->
        <div id="factions" class="tab-content hidden">
          <div class="card">
            <div class="card-header">
              <h3>Fac√ß√µes e Organiza√ß√µes</h3>
              <button class="btn btn-primario" data-action="openFactionModal">Nova Fac√ß√£o</button>
            </div>
            
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Buscar fac√ß√µes...">
            </div>
            
            <div class="list-item">
              <div>
                <strong>Irmandade do Anel</strong>
                <div class="text-sm text-muted">Alian√ßa ‚Ä¢ 9 membros</div>
                <div class="tag">Protagonistas</div>
              </div>
              <div>
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Sub-painel: Itens -->
        <div id="items" class="tab-content hidden">
          <div class="card">
            <div class="card-header">
              <h3>Itens e Artefatos</h3>
              <button class="btn btn-primario" data-action="openItemModal">Novo Item</button>
            </div>
            
            <div class="grid grid-2">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Buscar itens...">
              </div>
              <div class="form-group">
                <select class="form-control">
                  <option>Todos os tipos</option>
                  <option>Arma</option>
                  <option>Armadura</option>
                  <option>Artefato</option>
                  <option>Consum√≠vel</option>
                </select>
              </div>
            </div>
            
            <div class="item-list" id="itemList">
              <div class="list-item">
                <div>
                  <strong>And√∫ril</strong>
                <div class="text-sm text-muted">Espada ‚Ä¢ Lend√°ria</div>
                  <div class="tag">Arma</div>
                  <div class="tag">√önica</div>
                </div>
                <div>
                  <button class="btn">Editar</button>
                  <button class="btn btn-danger">Excluir</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Painel: Economia -->
      <section id="economy" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Sistema Econ√¥mico</h2>
          </div>
          
            <div class="grid grid-2">
              <div>
                <h3>Moedas</h3>
              <div class="form-group">
                <label>Nome da Moeda</label>
                <input type="text" class="form-control" placeholder="ex: Moedas de Ouro">
              </div>
              <div class="form-group">
                <label>S√≠mbolo</label>
                <input type="text" class="form-control" placeholder="ex: ü™ô" maxlength="5">
              </div>
              <div class="form-group">
                <label>Taxa de C√¢mbio (base)</label>
                <input type="number" class="form-control" placeholder="1.0" step="0.1">
              </div>
              <button class="btn btn-primario">Adicionar Moeda</button>
            </div>
            
            <div>
              <h3>Recursos</h3>
              <div class="form-group">
                <label>Nome do Recurso</label>
                <input type="text" class="form-control" placeholder="ex: Min√©rio de Ferro">
              </div>
              <div class="form-group">
                <label>Raridade</label>
                <select class="form-control">
                  <option>Comum</option>
                  <option>Incomum</option>
                  <option>Raro</option>
                  <option>√âpico</option>
                  <option>Lend√°rio</option>
                </select>
              </div>
              <div class="form-group">
                <label>Valor Base</label>
                <input type="number" class="form-control" placeholder="100">
              </div>
              <button class="btn btn-primario">Adicionar Recurso</button>
            </div>
          </div>
          
          <div class="card mt-16">
            <h3>Mercados e Pre√ßos</h3>
            <table class="table">
              <thead>
                <tr>
                  <th>Item</th>
                  <th>Regi√£o</th>
                  <th>Pre√ßo</th>
                  <th>A√ß√µes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>P√£o</td>
                  <td>Gondor</td>
                  <td>2 ü™ô</td>
                  <td>
                    <button class="btn">Editar</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Painel: L√≠nguas -->
      <section id="languages" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Sistema de L√≠nguas</h2>
            <button class="btn btn-primario" data-action="openLanguageModal">Nova L√≠ngua</button>
          </div>
          
          <div class="grid grid-2" id="languageList">
            <div class="card">
              <h3>√âlfico (Sindarin)</h3>
              <div class="form-group">
                <label>Fam√≠lia Lingu√≠stica</label>
                <input type="text" class="form-control" value="√âlfica" readonly>
              </div>
              <div class="form-group">
                <label>Falantes</label>
                <input type="text" class="form-control" value="Elfos de Rivendell, Lothl√≥rien" readonly>
              </div>
              <div class="form-group">
                <label>Script</label>
                <input type="text" class="form-control" value="Tengwar" readonly>
              </div>
              <div class="form-group">
                <label>Exemplo</label>
                <textarea class="form-control" rows="2" readonly>Mae govannen - Bem-vindos</textarea>
              </div>
              <button class="btn">Editar</button>
              <button class="btn btn-danger">Excluir</button>
            </div>
            
            <div class="card">
              <h3>L√≠ngua Negra</h3>
              <div class="form-group">
                <label>Fam√≠lia Lingu√≠stica</label>
                <input type="text" class="form-control" value="L√≠nguas Sombrias" readonly>
              </div>
              <div class="form-group">
                <label>Falantes</label>
                <input type="text" class="form-control" value="Orcs, Nazg√ªl" readonly>
              </div>
              <div class="form-group">
                <label>Script</label>
                <input type="text" class="form-control" value="Runas Sombrias" readonly>
              </div>
              <div class="form-group">
                <label>Exemplo</label>
                <textarea class="form-control" rows="2" readonly>Ash nazg durbatul√ªk - Um anel para domin√°-los</textarea>
              </div>
              <button class="btn">Editar</button>
              <button class="btn btn-danger">Excluir</button>
            </div>
          </div>
          
          <div class="card">
            <h3>Dicion√°rio e Tradu√ß√µes</h3>
            <div class="grid grid-3">
              <div class="form-group">
                <label>Palavra</label>
                <input type="text" class="form-control" placeholder="ex: mellon">
              </div>
              <div class="form-group">
                <label>L√≠ngua</label>
                <select class="form-control">
                  <option>√âlfico</option>
                  <option>L√≠ngua Negra</option>
                </select>
              </div>
              <div class="form-group">
                <label>Tradu√ß√£o</label>
                <input type="text" class="form-control" placeholder="ex: amigo">
              </div>
            </div>
            <button class="btn btn-primario">Adicionar Palavra</button>
          </div>
        </div>
      </section>

      <!-- Painel: Linha do Tempo -->
      <section id="timeline" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Linha do Tempo</h2>
            <button class="btn btn-primario" data-action="openEventModal">Novo Evento</button>
          </div>
          
          <div class="form-group">
            <label>Filtrar por Era/Per√≠odo</label>
            <select class="form-control">
              <option>Todos os per√≠odos</option>
              <option>Primeira Era</option>
              <option>Segunda Era</option>
              <option>Terceira Era</option>
              <option>Quarta Era</option>
            </select>
          </div>
          
          <div id="eventList" class="timeline">
            <div class="card timeline-entry">
              <div class="timeline-dot bg-primary"></div>
              <strong>T.A. 3018</strong> - In√≠cio da Jornada do Anel
              <div class="text-sm text-muted mt-4">
                Frodo deixa o Condado com o Um Anel
              </div>
              <div class="tag">Importante</div>
              <div class="mt-8">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>

            <div class="card timeline-entry">
              <div class="timeline-dot bg-success"></div>
              <strong>T.A. 3019</strong> - Batalha dos Campos de Pelennor
              <div class="text-sm text-muted mt-4">
                Vit√≥ria decisiva contra as for√ßas de Mordor
              </div>
              <div class="tag">Batalha</div>
              <div class="mt-8">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>

            <div class="card timeline-entry">
              <div class="timeline-dot bg-warning"></div>
              <strong>T.A. 3019</strong> - Destrui√ß√£o do Anel
              <div class="text-sm text-muted mt-4">
                O Um Anel √© destru√≠do na Montanha da Perdi√ß√£o
              </div>
              <div class="tag">Cl√≠max</div>
              <div class="mt-8">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Painel: Notas -->
      <section id="notes" class="content-panel">
        <div class="card">
          <div class="card-header">
            <h2>Notas e Ideias</h2>
            <button class="btn btn-primario" data-action="openNoteModal">Nova Nota</button>
          </div>
          
          <div class="grid grid-2">
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Buscar notas...">
            </div>
            <div class="form-group">
              <select class="form-control">
                <option>Todas as categorias</option>
                <option>Ideias de enredo</option>
                <option>Desenvolvimento de personagens</option>
                <option>Worldbuilding</option>
                <option>Pesquisa</option>
                <option>Refer√™ncias</option>
              </select>
            </div>
          </div>
          
          <div class="grid grid-2" id="noteList">
            <div class="card">
              <div class="card-header">
                <strong>Sistema de Magia</strong>
                <span class="text-xs text-muted">h√° 2 dias</span>
              </div>
              <p class="text-sm my-8">
                Desenvolver sistema baseado em palavras de poder. Cada palavra tem custo energ√©tico...
              </p>
              <div class="tag">Worldbuilding</div>
              <div class="tag">Magia</div>
              <div class="mt-12">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <strong>Arco do Gandalf</strong>
                <span class="text-xs text-muted">h√° 1 semana</span>
              </div>
              <p class="text-sm my-8">
                Transforma√ß√£o de Gandalf Cinzento para Branco representa crescimento espiritual...
              </p>
              <div class="tag">Personagem</div>
              <div class="tag">Desenvolvimento</div>
              <div class="mt-12">
                <button class="btn">Editar</button>
                <button class="btn btn-danger">Excluir</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
  <script type="module" src="/js/main.js"></script>
  <script src="/js/scripts.js"></script>
  <script src="/js/utils.js"></script>

</body>
</html>
